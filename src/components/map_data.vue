<template>
	<div class="bg clearfix">
		<div style="position: absolute;top: 0;left: 0;bottom: 0;width: 100%;background-color: #FFFFFF;" ref="my_chart"></div>
		<div class="wrap clearfix">
			<Card title="基础资源"  :padding="0" style="width: 200px;height: 400px;" class="l card">
	            <CellGroup>
	                <Cell :title="d.name"  v-for="d in list_data" @click.native="getMinData(d)" />
	            </CellGroup>
	        </Card>
	        <transition  enter-active-class="animated fadeIn" leave-active-class="animated fadeOut">
		        <Card  :padding="0" style="width: 200px;height: 400px;margin-left: 10px;" class="l card list" v-show="min_data.length">
		        	<p slot="title">{{page_title}}</p>
		            <CellGroup>
		                <Cell :title="d.unitName"  v-for="d in filter_min_data" @click.native="getMinData(d)"/>
		            </CellGroup>
		            <div   class="page-wrap">
			            <Page  :current="1" :total="min_data.length" simple :page-size="pageSize"  @on-change="pageChange"/>
		            </div>
		        </Card>
	        </transition >
		</div>
	</div>
</template>

<script>
	import MyTable from "@/base/table.vue";
	export default {
		
		data() {
			return {
				option: {},
				echart: null,
				list_data:[],
				min_data:[],
				filter_min_data:[],
				page_title:'',
				pageIndex:1,
	 			pageSize:8,
			}
		},
		props: {

		},
		computed: {
		},
		components: {
			MyTable
		},
		methods: {
			initOpction() {
				return;
				//所有的酒店 数据
        		var geoCoorddata = [{"value":[120.4413750000000,29.0514720000000],"name":"宝得利大酒店"},{"value":[120.7195970000000,29.2202990000000],"name":"金砖大酒店"},{"value":[120.7326180000000,29.2278780000000],"name":"金泰大酒店"},{"value":[120.5661980000000,28.9134820000000],"name":"大湖山酒店（建设中）3"},{"value":[120.4344150000000,28.9779580000000],"name":"新城酒店"},{"value":[120.4672580000000,29.0212920000000],"name":"大盘山温泉山庄"},{"value":[120.4552070000000,29.0603870000000],"name":"盛泰大酒店"},{"value":[120.4561790000000,29.0648810000000],"name":"翡翠湖建国度假酒店"},{"value":[120.4531980000000,29.0601470000000],"name":"云峰酒店3"},{"value":[120.4530840000000,29.0598140000000],"name":"磐城饭店"},{"value":[120.4517930000000,29.0591530000000],"name":"首创商务酒店"},{"value":[120.4424760000000,29.0654650000000],"name":"磐安山水大酒店"},{"value":[120.4396840000000,29.0500360000000],"name":"伟业大酒店"},{"value":[120.4462220000000,29.0519290000000],"name":"百度风尚酒店"},{"value":[120.4469230000000,29.0453970000000],"name":"磐安大酒店"},{"value":[120.4496240000000,29.0603680000000],"name":"花台山宾馆"},{"value":[120.4389680000000,29.0502840000000],"name":"伟业大酒店"}];
        		var ranges = ["120.790088, 29.226124", "120.7799, 29.231766", "120.783715, 29.24761", "120.780023, 29.25326", "120.780686, 29.260506", "120.775765, 29.264565", "120.777543, 29.271153", "120.782243, 29.273488", "120.777144, 29.277032", "120.781367, 29.277518", "120.784781, 29.284524", "120.762195, 29.284728", "120.769127, 29.290784", "120.768948, 29.294231", "120.765134, 29.294734", "120.769685, 29.300729", "120.780394, 29.296045", "120.777091, 29.29992", "120.780977, 29.307577", "120.772845, 29.31726", "120.761338, 29.32065", "120.757377, 29.325463", "120.756561, 29.320092", "120.749621, 29.315336", "120.745209, 29.317025", "120.742211, 29.314888", "120.7441, 29.312935", "120.738009, 29.310905", "120.735122, 29.29515", "120.726654, 29.292914", "120.72705, 29.286793", "120.721543, 29.279682", "120.723483, 29.270834", "120.720177, 29.272041", "120.715166, 29.2652", "120.703382, 29.270491", "120.69524, 29.266669", "120.693915, 29.275874", "120.685498, 29.274575", "120.675434, 29.281275", "120.665652, 29.281182", "120.63942, 29.255173", "120.636014, 29.242534", "120.6249, 29.242181", "120.610278, 29.235916", "120.602893, 29.237164", "120.603698, 29.222153", "120.596661, 29.219641", "120.591744, 29.210504", "120.588136, 29.21306", "120.584307, 29.209016", "120.585735, 29.204414", "120.577356, 29.205227", "120.568293, 29.1963", "120.566029, 29.18955", "120.569324, 29.184294", "120.562563, 29.175956", "120.554151, 29.174759", "120.540964, 29.162083", "120.537732, 29.165459", "120.526539, 29.16335", "120.511582, 29.175101", "120.50571, 29.162283", "120.486427, 29.157683", "120.478599, 29.151189", "120.478213, 29.140494", "120.481738, 29.13627", "120.501631, 29.136208", "120.499927, 29.133174", "120.504944, 29.1239", "120.504977, 29.11385", "120.500993, 29.111929", "120.497415, 29.09745", "120.500963, 29.098799", "120.498914, 29.085378", "120.502286, 29.074996", "120.490745, 29.074844", "120.49123, 29.084837", "120.488467, 29.082748", "120.486668, 29.090446", "120.476028, 29.090177", "120.474469, 29.096565", "120.470406, 29.092989", "120.462646, 29.095614", "120.457335, 29.08404", "120.449214, 29.088879", "120.426545, 29.077543", "120.419306, 29.078252", "120.420313, 29.070917", "120.40962, 29.054805", "120.416762, 29.045413", "120.410684, 29.03922", "120.411256, 29.03376", "120.401797, 29.022229", "120.395789, 29.020342", "120.399716, 29.016405", "120.394005, 29.008424", "120.384193, 29.009114", "120.38288, 29.004947", "120.386289, 29.002229", "120.378163, 28.999271", "120.379942, 28.989287", "120.386436, 28.988695", "120.382359, 28.981476", "120.374272, 28.972727", "120.364601, 28.978314", "120.359281, 28.975779", "120.355917, 28.978317", "120.354695, 28.967684", "120.349625, 28.969206", "120.333063, 28.960339", "120.313988, 28.937976", "120.311725, 28.931385", "120.320842, 28.920648", "120.314412, 28.912511", "120.313913, 28.90002", "120.309304, 28.897458", "120.31396, 28.892798", "120.317652, 28.894211", "120.322385, 28.891134", "120.325103, 28.884582", "120.322829, 28.881614", "120.340833, 28.87151", "120.343529, 28.866187", "120.353227, 28.863899", "120.354085, 28.856143", "120.358386, 28.855298", "120.363681, 28.845065", "120.374376, 28.843373", "120.380708, 28.838328", "120.386801, 28.839649", "120.39159, 28.835249", "120.396291, 28.836151", "120.400876, 28.844897", "120.398355, 28.850722", "120.407498, 28.861347", "120.41317, 28.850987", "120.421022, 28.851701", "120.424894, 28.855815", "120.432572, 28.836193", "120.45056, 28.847106", "120.469908, 28.845549", "120.474288, 28.847817", "120.480846, 28.845445", "120.483563, 28.835836", "120.487893, 28.833945", "120.491721, 28.838872", "120.489682, 28.842674", "120.494782, 28.84692", "120.493518, 28.851967", "120.504872, 28.85363", "120.503599, 28.85996", "120.509299, 28.862633", "120.502, 28.875249", "120.51774, 28.880257", "120.517438, 28.889748", "120.521502, 28.89634", "120.526916, 28.893722", "120.525004, 28.889076", "120.530225, 28.884679", "120.536442, 28.883325", "120.538286, 28.885901", "120.543194, 28.882996", "120.538638, 28.879737", "120.541085, 28.87135", "120.551871, 28.873338", "120.559937, 28.867406", "120.568101, 28.866795", "120.5884, 28.875989", "120.596164, 28.88654", "120.611966, 28.897344", "120.62589, 28.90224", "120.645685, 28.901913", "120.645169, 28.90676", "120.655389, 28.906693", "120.671322, 28.92236", "120.667072, 28.944648", "120.68021, 28.962866", "120.680936, 28.979732", "120.699925, 28.98619", "120.703796, 28.985437", "120.704181, 28.9781", "120.710515, 28.981306", "120.71585, 28.977973", "120.723735, 28.979768", "120.725637, 28.985366", "120.735146, 28.988964", "120.727561, 29.001", "120.735586, 29.013601", "120.732883, 29.019711", "120.7265, 29.017472", "120.731166, 29.031637", "120.726069, 29.031426", "120.724373, 29.036158", "120.721643, 29.034824", "120.721457, 29.043327", "120.713361, 29.038716", "120.71537, 29.030192", "120.71228, 29.027403", "120.702349, 29.034311", "120.69828, 29.047176", "120.703998, 29.045118", "120.707225, 29.050385", "120.696286, 29.057795", "120.703024, 29.056135", "120.70228, 29.060529", "120.708772, 29.062042", "120.711434, 29.080366", "120.700514, 29.091746", "120.7006, 29.095342", "120.728649, 29.114822", "120.725431, 29.117561", "120.73038, 29.126075", "120.735081, 29.120648", "120.742395, 29.119319", "120.751325, 29.123707", "120.753272, 29.128459", "120.750084, 29.1327", "120.743224, 29.13261", "120.741516, 29.136903", "120.735939, 29.136468", "120.734643, 29.139835", "120.726207, 29.136208", "120.724963, 29.142216", "120.719954, 29.143692", "120.72285, 29.146132", "120.718196, 29.149924", "120.719655, 29.154907", "120.726435, 29.156155", "120.732678, 29.165476", "120.729844, 29.168992", "120.745875, 29.174355", "120.761032, 29.185615", "120.762388, 29.193843", "120.770778, 29.197653", "120.767528, 29.20366", "120.770846, 29.200904", "120.773442, 29.206453", "120.778667, 29.200655", "120.783352, 29.204449", "120.778752, 29.212628", "120.783934, 29.215324", "120.781203, 29.219561", "120.788834, 29.221456", "120.790088, 29.226124"];
       			this.option = {
	                tooltip: {
	                    trigger: 'item',
	                    /*backgroundColor: 'rgba(12, 204, 104, 0.92)',*/
	                    backgroundColor: 'rgba(0, 0, 0, 0.7)',
	                    borderColor: '#FFFFCC',
	                    showDelay: 0,
	                    hideDelay: 0,
	                    enterable: true,
	                    /*triggerOn: 'click',*/
	                    transitionDuration: 0,
	                    extraCssText: 'z-index:100',
	                    formatter: function (params, ticket, callback) {
	                        //根据业务自己拓展要显示的内容
	                        var name = params.name;
	                        var value = params.value;
	                        var res = "<span style='color:#fff;'>" + name + "</span>";
	                        return res;
	                    }
	                },
	                bmap: {
	                    center: [120.456526, 29.060497],
	                    zoom: 12,
	                    roam: true,
	                    mapStyle: {//地区上各种元素的样式调整
	                        styleJson: []
	                    }
	                },
	                series: [{
	                    name: '点',
	                    type: 'scatter',
	                    coordinateSystem: 'bmap',
	                    symbol: 'pin', //气泡
	                    symbolSize: 40,
	                    data: geoCoorddata,
	                    label: {
	                        normal: {
	                            show: true,
	                            // show: false,
	                            position: 'inside',
	                            // formatter: '{b}'
	                            color: '#fff',
	                            fontSize: 14,
	                            formatter: function (params, ticket, callback) {
	                                //根据业务自己拓展要显示的内容
	                                var res = "";
	                                var name = params.name;
	                                var value = params.value;
	                                return '';
	                            }
	                        },
	                        emphasis: {
								show: true
							}
	                         
	                    },
	                   
	                    itemStyle: {
	                        normal: {
	                            color: '#F62157', //标志颜色
	                            show: true
	                        },
	                        emphasis: {
								show: true
							}
	                    },
	                    zlevel: 6
	
	                }, { //多边形
	                    type: 'custom',
	                    coordinateSystem: 'bmap',
	                    renderItem: function (params, api) {
	                        var polygons = [];
	                        
	                            var points = [];
	                        for (var i = 0; i < ranges.length; i++) {
	                            points.push(api.coord(ranges[i].split(',')));
	                            }
	                            polygons.push({
	                                type: 'polygon',
	                                shape: {
	                                    points: points
	                                },
	                                style: api.style({
	                                    fill: 'rgba(0,0,0,0.3)',//磐安县的颜色
	                                    stroke: '#1c5473',//#3449EA
	                                    lineWidth: 1,
	                                })
	                            });
	                     
	                        return {
	                            type: 'group',
	                            children: polygons
	                        };
	                    },
	                    itemStyle: {
	                        normal: {
	                            opacity: 1
	                        }
	                    },
	                    animation: false,
	                    silent: false,
	                    data: [0],
	                    zlevel: 0,
	                    tooltip: {
	                        trigger: '',
	                        backgroundColor: 'rgba(12, 204, 104, 0.92)',
	                        borderColor: '#FFFFCC',
	                        showDelay: 0,
	                        hideDelay: 0,
	                        enterable: true,
	                        transitionDuration: 0,
	                        extraCssText: 'z-index:100'
	                    },
	                },]
	            };
			},
			creatChart() {
				
				
				this.initOpction();
				this.echart && this.echart.dispose();
				this.echart = this.echarts.init(this.$refs.my_chart);
				this.echart.setOption(this.option);
			},
			getData () {
    			this.$ajax.post('/api/AllInterface').then(data=>{
    				this.list_data = data.data;
    			});
			},
			getMinData (_data) {
				this.page_title = _data.name;
				this.$ajax.post('/api/'+_data.value).then(data=>{
    				this.min_data = data.data;
    				this.getFilterMinData();
    			})
			},
			pageChange(index) {
				this.pageIndex = index;
				this.getFilterMinData();
			},
			getFilterMinData() {
				this.$set(this,'filter_min_data',this.min_data.splice((this.index-1) * this.pageSize,this.pageSize));
			}

		},
		created() {
			this.$nextTick(() => {
				this.creatChart();
				this.getData();
			})
		},

	}
</script>

<style scoped>
	.wrap {
		position: absolute;
		top: 50px;
		left: 50px;
		
	}
	.title {
		font-size: 24px;
	}
	.page-wrap {
		position: absolute;
		bottom: 10px;
		left: 0;
		width: 100%;
		color: #000000;
		text-align: center;
	}
	.page {
		display: inline-block;
	}
	.card {
		overflow: hidden;
	}
</style>